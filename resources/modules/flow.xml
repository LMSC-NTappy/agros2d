<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<module:module xmlns:module="XMLModule" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="XMLModule ../xsd/module_xml.xsd">

  <module:general id="flow" name="Incompressible flow">
    <module:description>Incompressible flow model using Navier-Stokes equations.</module:description>
    <module:analyses>
      <module:analysis id="steadystate" name="Steady state" solutions="3" type="steadystate"/>
      <module:analysis id="transient" name="Transient" solutions="3" type="transient"/>
    </module:analyses>
  </module:general>

  <module:constants/>

  <module:spaces>
    <module:space analysistype="steadystate">
        <module:space_config i="1" type="h1" orderadjust="0" />
        <module:space_config i="2" type="h1" orderadjust="0" />
        <module:space_config i="3" type="l2" orderadjust="-1" />
    </module:space>
    <module:space analysistype="transient">
        <module:space_config i="1" type="h1" orderadjust="0" />
        <module:space_config i="2" type="h1" orderadjust="0" />
        <module:space_config i="3" type="l2" orderadjust="-1" />
    </module:space>
  </module:spaces>

  <module:volume>
    <module:quantity id="flow_viscosity" shortname="fl_mu"/>
    <module:quantity id="flow_density" shortname="fl_rho"/>
    <module:quantity id="flow_force_x" shortname="fl_fx"/>
    <module:quantity id="flow_force_y" shortname="fl_fy"/>
    <module:weakforms_volume>
      <module:weakform_volume analysistype="steadystate"
        equation="\rho \vec{v} \cdot \grad \vec{v} = -\, \grad p + \mu \triangle \vec{v} + \vec{f},~\div \vec{v} = 0">
        <module:quantity id="flow_viscosity"/>
        <module:quantity id="flow_density"/>
        <module:quantity id="flow_force_x"/>
        <module:quantity id="flow_force_y"/>
        <module:matrix_form id="form" axi_linear="fl_mu * (r*r * udr * vdr - r * udr * vval + uval * vval + r*r * udz * vdz)" axi_newton="fl_mu * (r*r * udr * vdr - r * udr * vval + uval * vval + r*r * udz * vdz) + fl_rho * r*r * (value1 * udr + value2 * udz + dr1 * uval) * vval" i="1" j="1" planar_linear="fl_mu * (udx * vdx + udy * vdy)" planar_newton="fl_mu * (udx * vdx + udy * vdy) + fl_rho * (value1 * udx + value2 * udy + dx1 * uval) * vval"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="fl_rho * r*r * dz1 * uval * vval" i="1" j="2" planar_linear="0" planar_newton="fl_rho * dy1 * uval * vval"/>
        <module:matrix_form id="form" axi_linear="- r*r * uval * vdr" axi_newton="- r*r * uval * vdr" i="1" j="3" planar_linear=" - uval * vdx" planar_newton=" - uval * vdx"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="fl_rho * r*r * dr2 * uval * vval" i="2" j="1" planar_linear="0" planar_newton="fl_rho * dx2 * uval * vval"/>
        <module:matrix_form id="form" axi_linear="fl_mu * (r * udr * vdr - udr * vval + r * udz * vdz)" axi_newton="fl_mu * (r * udr * vdr - udr * vval + r * udz * vdz) + fl_rho * r * (value1 * udr + value2 * udz + dz2 * uval) * vval" i="2" j="2" planar_linear="fl_mu * (udx * vdx + udy * vdy)" planar_newton="fl_mu * (udx * vdx + udy * vdy) + fl_rho * (value1 * udx + value2 * udy + dy2 * uval) * vval"/>
        <module:matrix_form id="form" axi_linear="- r * uval * vdz" axi_newton="- r * uval * vdz" i="2" j="3" planar_linear=" - uval * vdy" planar_newton=" - uval * vdy"/>
        <module:matrix_form id="form" axi_linear="r * udr * vval + uval * vval" axi_newton="r * udr * vval + uval * vval" i="3" j="1" planar_linear="udx * vval" planar_newton="udx * vval"/>
        <module:matrix_form id="form" axi_linear="udz * vval" axi_newton="udz * vval" i="3" j="2" planar_linear="udy * vval" planar_newton="udy * vval"/>
        <module:vector_form id="form" axi_linear="r*r * fl_fx * vval" axi_newton="fl_mu * (r*r * updr * vdr - r * updr * vval + upval * vval + r*r * updz * vdz) - r*r * value3 * vdr + fl_rho * r*r * (value1 * dr1 + value2 * dz1) * vval - r*r * fl_fx * vval" i="1" j="1" planar_linear="fl_fx * vval" planar_newton="fl_mu * (updx * vdx + updy * vdy) - value3 * vdx + fl_rho * (value1 * dx1 + value2 * dy1) * vval - fl_fx * vval"/>
        <module:vector_form id="form" axi_linear="r * fl_fy * vval" axi_newton="fl_mu * (r * updr * vdr - updr * vval + r * updz * vdz) - r * value3 * vdz + fl_rho * r * (value1 * dr2 + value2 * dz2) * vval - r * fl_fy * vval" i="2" j="2" planar_linear="fl_fy * vval" planar_newton="fl_mu * (updx * vdx + updy * vdy) - value3 * vdy + fl_rho * (value1 * dx2 + value2 * dy2) * vval - fl_fy * vval"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="(r * dr1 + value1 + r * dz2) * vval" i="3" j="3" planar_linear="0" planar_newton="(dx1 + dy2) * vval"/>
      </module:weakform_volume>
      <module:weakform_volume analysistype="transient"
        equation="\rho \left( \frac{\partial \vec{v}}{\partial t} + \vec{v} \cdot \grad \vec{v} \right) = -\, \grad p + \mu \triangle \vec{v} + \vec{f},~\div \vec{v} = 0">
        <module:quantity id="flow_viscosity"/>
        <module:quantity id="flow_density"/>
        <module:quantity id="flow_force_x"/>
        <module:quantity id="flow_force_y"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="0" i="1" j="1" planar_linear="fl_mu * (udx * vdx + udy * vdy)" planar_newton="fl_mu * (udx * vdx + udy * vdy) + fl_rho * (value1 * udx + value2 * udy + dx1 * uval + uval / deltat) * vval"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="0" i="1" j="2" planar_linear="0" planar_newton="fl_rho * dy1 * uval * vval"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="0" i="1" j="3" planar_linear=" - uval * vdx" planar_newton=" - uval * vdx"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="0" i="2" j="1" planar_linear="0" planar_newton="fl_rho * dx2 * uval * vval"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="0" i="2" j="2" planar_linear="fl_mu * (udx * vdx + udy * vdy)" planar_newton="fl_mu * (udx * vdx + udy * vdy) + fl_rho * (value1 * udx + value2 * udy + dy2 * uval + uval / deltat) * vval"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="0" i="2" j="3" planar_linear=" - uval * vdy" planar_newton=" - uval * vdy"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="0" i="3" j="1" planar_linear="udx * vval" planar_newton="udx * vval"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="0" i="3" j="2" planar_linear="udy * vval" planar_newton="udy * vval"/>
        <module:matrix_form id="form" axi_linear="0" axi_newton="0" i="3" j="3" planar_linear="0" planar_newton="0"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="0" i="1" j="1" planar_linear="fl_fx * vval" planar_newton="fl_mu * (dx1 * vdx + dy1 * vdy) - value3 * vdx + fl_rho * (value1 * dx1 + value2 * dy1 + (upval - uptval) / deltat) * vval - fl_fx * vval"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="0" i="1" j="2" planar_linear="0" planar_newton="0"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="0" i="1" j="3" planar_linear="0" planar_newton="0"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="0" i="2" j="1" planar_linear="0" planar_newton="0"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="0" i="2" j="2" planar_linear="fl_fy * vval" planar_newton="fl_mu * (dx2 * vdx + dy2 * vdy) - value3 * vdy + fl_rho * (value1 * dx2 + value2 * dy2 + (upval - uptval) / deltat) * vval - fl_fy * vval"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="0" i="2" j="3" planar_linear="0" planar_newton="0"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="0" i="3" j="1" planar_linear="0" planar_newton="0"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="0" i="3" j="2" planar_linear="0" planar_newton="0"/>
        <module:vector_form id="form" axi_linear="0" axi_newton="0" i="3" j="3" planar_linear="0" planar_newton="(dx1 + dy2) * vval"/>
      </module:weakform_volume>
    </module:weakforms_volume>
  </module:volume>

  <module:surface>
    <module:quantity id="flow_velocity_x" shortname="fl_vx"/>
    <module:quantity id="flow_velocity_y" shortname="fl_vy"/>
    <module:quantity id="flow_pressure" shortname="fl_p"/>
    <module:weakforms_surface>
      <module:weakform_surface analysistype="steadystate" default="flow_velocity">
        <module:boundary id="flow_velocity" name="Velocity"
          equation="">
          <module:quantity dependence="space" id="flow_velocity_x"/>
          <module:quantity dependence="space" id="flow_velocity_y"/>
          <module:essential_form id="form" axi_linear="fl_vx" axi_newton="fl_vx" i="1" planar_linear="fl_vx" planar_newton="fl_vx"/>
          <module:essential_form id="form" axi_linear="fl_vy" axi_newton="fl_vy" i="2" planar_linear="fl_vy" planar_newton="fl_vy"/>
        </module:boundary>
        <module:boundary id="fluid_outlet" name="Outlet"
          equation="">
          <module:vector_form id="form" axi_linear="0" axi_newton="0" i="1" j="1" planar_linear="0" planar_newton="0"/>
          <module:vector_form id="form" axi_linear="0" axi_newton="0" i="2" j="2" planar_linear="0" planar_newton="0"/>
        </module:boundary>
        <module:boundary id="fluid_pressure" name="Pressure"
          equation="">
          <module:quantity dependence="space" id="flow_pressure"/>
          <module:essential_form id="form" axi_linear="fl_p" axi_newton="fl_p" i="3" planar_linear="fl_p" planar_newton="fl_p"/>
        </module:boundary>
      </module:weakform_surface>
      <module:weakform_surface analysistype="transient" default="flow_velocity">
        <module:boundary id="flow_velocity" name="Velocity"
          equation="">
          <module:quantity dependence="time-space" id="flow_velocity_x"/>
          <module:quantity dependence="time-space" id="flow_velocity_y"/>
          <module:essential_form id="form" axi_linear="fl_vx" axi_newton="fl_vx" i="1" planar_linear="fl_vx" planar_newton="fl_vx"/>
          <module:essential_form id="form" axi_linear="fl_vy" axi_newton="fl_vy" i="2" planar_linear="fl_vy" planar_newton="fl_vy"/>
        </module:boundary>
        <module:boundary id="fluid_outlet" name="Outlet"
          equation="">
          <module:vector_form id="form" axi_linear="0" axi_newton="0" i="1" j="1" planar_linear="0" planar_newton="0"/>
          <module:vector_form id="form" axi_linear="0" axi_newton="0" i="2" j="2" planar_linear="0" planar_newton="0"/>
        </module:boundary>
      </module:weakform_surface>
    </module:weakforms_surface>
  </module:surface>

  <module:preprocessor>
    <module:gui type="volume">
      <module:group>
        <module:quantity id="flow_density" name="Density" shortname="rho" shortname_html="&lt;i>&amp;rho;&lt;/i>" shortname_latex="\rho" unit="kg/m3" unit_html="kg.m&lt;sup>-3&lt;/sup>" unit_latex="kg \cdot m^{-3}"/>
        <module:quantity id="flow_viscosity" name="Viscosity" shortname="mu" shortname_html="&lt;i>&amp;mu;&lt;/i>" shortname_latex="\mu" unit="Pa.s" unit_html="Pa.s" unit_latex="Pa\cdot s"/>
        <module:quantity id="flow_force_x" name="Force - x" shortname="fx" shortname_html="&lt;i>f&lt;/i>&lt;sub>x&lt;/sub>" shortname_latex="f_{x}" unit="N/m3" unit_html="N.m&lt;sup>-3&lt;/sup>" unit_latex="N \cdot m^{-3}"/>
        <module:quantity id="flow_force_y" name="Force - y" shortname="fy" shortname_html="&lt;i>f&lt;/i>&lt;sub>y&lt;/sub>" shortname_latex="f_{y}" unit="N/m3" unit_html="N.m&lt;sup>-3&lt;/sup>" unit_latex="N \cdot m^{-3}"/>
      </module:group>
    </module:gui>
    <module:gui type="surface">
      <module:group name="Velocity">
        <module:quantity id="flow_velocity_x" name="Velocity - x" shortname="vx" shortname_html="&lt;i>v&lt;/i>&lt;sub>x&lt;/sub>" shortname_latex="v_\mathrm{x}" unit="m/s" unit_html="m.s&lt;sup>-1&lt;/sup>" unit_latex="m\cdot s^{-1}"/>
        <module:quantity id="flow_velocity_y" name="Velocity - y" shortname="vy" shortname_html="&lt;i>v&lt;/i>&lt;sub>y&lt;/sub>" shortname_latex="v_\mathrm{y}" unit="m/s" unit_html="m.s&lt;sup>-1&lt;/sup>" unit_latex="m\cdot s^{-1}"/>
      </module:group>
      <module:group name="Pressure">
        <module:quantity id="flow_pressure" name="Pressure" shortname="p" shortname_html="&lt;i>p&lt;/i>&lt;" shortname_latex="p" unit="Pa" unit_html="Pa" unit_latex="Pa"/>
      </module:group>
    </module:gui>
  </module:preprocessor>

  <module:postprocessor>
    <module:localvariables>
      <module:localvariable id="flow_velocity" name="Velocity" shortname="v" shortname_html="&lt;i>v&lt;/i>" shortname_latex="v" type="vector" unit="m/s" unit_html="m.s&lt;sup>-1&lt;/sup>" unit_latex="m\cdot s^{-1}">
        <module:expression analysistype="steadystate" axi_r="value1" axi_z="value2" planar_x="value1" planar_y="value2"/>
        <module:expression analysistype="transient" axi_r="value1" axi_z="value2" planar_x="value1" planar_y="value2"/>
      </module:localvariable>
      <module:localvariable id="flow_pressure" name="Pressure" shortname="p" shortname_html="&lt;i>p&lt;/i>" shortname_latex="p" type="scalar" unit="Pa" unit_html="m" unit_latex="Pa">
        <module:expression analysistype="steadystate" axi="value3" planar="value3"/>
        <module:expression analysistype="transient" axi="value3" planar="value3"/>
      </module:localvariable>
      <module:localvariable id="flow_vorticity" name="Vorticity" shortname="vt" shortname_html="&lt;i>v&lt;/i>&lt;sub>t&lt;/sub>" shortname_latex="vt" type="scalar" unit="1/s" unit_html="s&lt;sup>-1&lt;/sup>" unit_latex="s^{-1}">
        <module:expression analysistype="steadystate" axi="dr2 - dz1" planar="dx2 - dy1"/>
        <module:expression analysistype="transient" axi="dr2 - dz1" planar="dx2 - dy1"/>
      </module:localvariable>
      <module:localvariable id="flow_density" name="Density" shortname="rho" shortname_html="&lt;i>&amp;rho;&lt;/i>" shortname_latex="\rho" type="scalar" unit="kg/m3" unit_html="kg.m&lt;sup>-3&lt;/sup>" unit_latex="kg \cdot m^{-3}">
        <module:expression analysistype="steadystate" axi="fl_rho" planar="fl_rho"/>
        <module:expression analysistype="transient" axi="fl_rho" planar="fl_rho"/>
      </module:localvariable>
      <module:localvariable id="flow_viscosity" name="Viscosity" shortname="mu" shortname_html="&lt;i>&amp;mu;&lt;/i>" shortname_latex="\mu" type="scalar" unit="Pa.s" unit_html="Pa.s" unit_latex="Pa\cdot s">
        <module:expression analysistype="steadystate" axi="fl_mu" planar="fl_mu"/>
        <module:expression analysistype="transient" axi="fl_mu" planar="fl_mu"/>
      </module:localvariable>
      <module:localvariable id="flow_inner_force" name="Inner force" shortname="f" shortname_html="&lt;i>f&lt;/i>" shortname_latex="f" type="vector" unit="N" unit_html="N" unit_latex="N">
        <module:expression analysistype="steadystate" axi_r="fl_fx" axi_z="fl_fy" planar_x="fl_fx" planar_y="fl_fy"/>
      </module:localvariable>
    </module:localvariables>
    <module:view>
      <module:scalar_view>
        <module:default analysistype="steadystate" id="flow_velocity"/>
        <module:default analysistype="transient" id="flow_velocity"/>
      </module:scalar_view>
      <module:vector_view>
        <module:default analysistype="steadystate" id="flow_velocity"/>
        <module:default analysistype="transient" id="flow_velocity"/>
      </module:vector_view>
    </module:view>
    <module:volumeintegrals>
      <module:volumeintegral id="flow_volume" name="Volume" shortname="V" shortname_html="&lt;i>V&lt;/i>" shortname_latex="V" unit="m3" unit_html="m&lt;sup>3&lt;/sup>" unit_latex="m^{3}">
        <module:expression analysistype="steadystate" axi="2.0 * PI * r" planar="1.0"/>
        <module:expression analysistype="transient" axi="2.0 * PI * r" planar="1.0"/>
      </module:volumeintegral>
    </module:volumeintegrals>
    <module:surfaceintegrals>
      <module:surfaceintegral id="flow_length" name="Length" shortname="l" shortname_html="&lt;i>l&lt;/i>" shortname_latex="l" unit="m" unit_html="m" unit_latex="m">
        <module:expression analysistype="steadystate" axi="1.0" planar="1.0"/>
        <module:expression analysistype="transient" axi="1.0" planar="1.0"/>
      </module:surfaceintegral>
      <module:surfaceintegral id="flow_force_x" name="Force X" shortname="Fx" shortname_html="&lt;i>F&lt;/i>&lt;sub>x&lt;/sub>" shortname_latex="F_\mathrm{x}" unit="N" unit_html="N" unit_latex="N">
        <module:expression analysistype="steadystate" axi="0" planar="0"/>
      </module:surfaceintegral>
      <module:surfaceintegral id="flow_force_y" name="Force Y" shortname="Fy" shortname_html="&lt;i>F&lt;/i>&lt;sub>y&lt;/sub>" shortname_latex="F_\mathrm{x}" unit="N" unit_html="N" unit_latex="N">
        <module:expression analysistype="steadystate" axi="0" planar="0"/>
      </module:surfaceintegral>
    </module:surfaceintegrals>
    <module:force/>
  </module:postprocessor>

</module:module>
